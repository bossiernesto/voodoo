package org.uqbar.voodoo.exhaustive

import org.scalatest.FreeSpec
import org.scalatest.Matchers
import org.scalatest.prop.TableDrivenPropertyChecks

class ExhaustiveMaxLocalsTest extends FreeSpec with TableDrivenPropertyChecks with Matchers {

	val maxLocals = Table(
		("Instruction", "MaxLocals"),
		("AALOAD", 2),
		("AASTORE", 3),
		("ACONST_NULL", 1),
		("ALOAD", 2),
		("ALOAD_0", 1),
		("ALOAD_1", 2),
		("ALOAD_2", 3),
		("ALOAD_3", 4),
		("ANEWARRAY", 1),
		("ARETURN", 1),
		("ARRAYLENGTH", 2),
		("ASTORE", 3),
		("ASTORE_0", 2),
		("ASTORE_1", 2),
		("ASTORE_2", 3),
		("ASTORE_3", 4),
		("ATHROW", 1),
		("BALOAD", 2),
		("BASTORE", 3),
		("BIPUSH", 1),
		("CALOAD", 2),
		("CASTORE", 3),
		("CHECKCAST", 2),
		("D2F", 3),
		("D2I", 3),
		("D2L", 3),
		("DADD", 1),
		("DALOAD", 2),
		("DASTORE", 4),
		("DCMPG", 5),
		("DCMPL", 5),
		("DCONST_0", 1),
		("DCONST_1", 1),
		("DDIV", 1),
		("DLOAD", 3),
		("DLOAD_0", 2),
		("DLOAD_1", 3),
		("DLOAD_2", 4),
		("DLOAD_3", 5),
		("DMUL", 1),
		("DNEG", 1),
		("DREM", 1),
		("DRETURN", 3),
		("DSTORE", 5),
		("DSTORE_0", 2),
		("DSTORE_1", 3),
		("DSTORE_2", 4),
		("DSTORE_3", 5),
		("DSUB", 1),
		("DUP", 2),
		("DUP_X1", 2),
		("DUP_X2", 2),
		("DUP2", 3),
		("DUP2_X1", 4),
		("DUP2_X2", 3),
		("F2D", 2),
		("F2I", 2),
		("F2L", 2),
		("FADD", 1),
		("FALOAD", 2),
		("FASTORE", 3),
		("FCMPG", 3),
		("FCMPL", 3),
		("FCONST_0", 1),
		("FCONST_1", 1),
		("FCONST_2", 1),
		("FDIV", 1),
		("FLOAD", 2),
		("FLOAD_0", 1),
		("FLOAD_1", 2),
		("FLOAD_2", 3),
		("FLOAD_3", 4),
		("FMUL", 1),
		("FNEG", 1),
		("FREM", 1),
		("FRETURN", 2),
		("FSTORE", 3),
		("FSTORE_0", 2),
		("FSTORE_1", 2),
		("FSTORE_2", 3),
		("FSTORE_3", 4),
		("FSUB", 1),
		("GETFIELD", 2),
		("GETSTATIC", 1),
		("GOTO", 1),
		("GOTO_W", 1),
		("I2B", 2),
		("I2C", 2),
		("I2D", 2),
		("I2F", 2),
		("I2L", 2),
		("I2S", 2),
		("IADD", 1),
		("IALOAD", 2),
		("IAND", 1),
		("IASTORE", 3),
		("ICONST_M1", 1),
		("ICONST_0", 1),
		("ICONST_1", 1),
		("ICONST_2", 1),
		("ICONST_3", 1),
		("ICONST_4", 1),
		("ICONST_5", 1),
		("IDIV", 1),
		("IF_ACMPEQ", 3),
		("IF_ACMPNE", 3),
		("IF_ICMPEQ", 4),
		("IF_ICMPNE", 3),
		("IF_ICMPLT", 3),
		("IF_ICMPGE", 3),
		("IF_ICMPGT", 3),
		("IF_ICMPLE", 3),
		("IFEQ", 2),
		("IFNE", 2),
		("IFLT", 2),
		("IFGE", 2),
		("IFGT", 2),
		("IFLE", 2),
		("IFNONNULL", 2),
		("IFNULL", 2),
		("IINC", 2),
		("ILOAD", 2),
		("ILOAD_0", 1),
		("ILOAD_1", 2),
		("ILOAD_2", 3),
		("ILOAD_3", 4),
		("IMUL", 1),
		("INEG", 1),
		("INSTANCEOF", 2),
		("INVOKEDYNAMIC", 3),
		("INVOKEINTERFACE", 3),
		("INVOKESPECIAL", 1),
		("INVOKESTATIC", 1),
		("INVOKEVIRTUAL", 2),
		("IOR", 1),
		("IREM", 1),
		("IRETURN", 2),
		("ISHL", 1),
		("ISHR", 1),
		("ISTORE", 4),
		("ISTORE_0", 2),
		("ISTORE_1", 2),
		("ISTORE_2", 3),
		("ISTORE_3", 4),
		("ISUB", 1),
		("IUSHR", 1),
		("IXOR", 1),
		("JSR", 2),
		("JSR_W", 2),
		("L2D", 3),
		("L2F", 3),
		("L2I", 3),
		("LADD", 1),
		("LALOAD", 2),
		("LAND", 1),
		("LASTORE", 4),
		("LCMP", 5),
		("LCONST_0", 1),
		("LCONST_1", 1),
		("LDC", 1),
		("LDC2_W", 1),
		("LDIV", 1),
		("LLOAD", 3),
		("LLOAD_0", 2),
		("LLOAD_1", 3),
		("LLOAD_2", 4),
		("LLOAD_3", 5),
		("LMUL", 1),
		("LNEG", 1),
		("LOOKUPSWITCH", 2),
		("LOR", 1),
		("LREM", 1),
		("LRETURN", 3),
		("LSHL", 1),
		("LSHR", 1),
		("LSTORE", 5),
		("LSTORE_0", 2),
		("LSTORE_1", 3),
		("LSTORE_2", 4),
		("LSTORE_3", 5),
		("LSUB", 1),
		("LUSHR", 1),
		("LXOR", 1),
		("MONITORENTER", 2),
		("MONITOREXIT", 2),
		("MULTIANEWARRAY", 1),
		("NEW", 1),
		("NEWARRAY", 1),
		("NOP", 1),
		("POP", 1),
		("POP2", 1),
		("PUTFIELD", 3),
		("PUTSTATIC", 2),
		("RET", 2),
		("RETURN", 1),
		("SALOAD", 2),
		("SASTORE", 3),
		("SIPUSH", 1),
		("SWAP", 1),
		("TABLESWITCH", 2),
		("WIDE", 301)
	)

	"MaxLocals should be as expected" in {
		forAll(maxLocals){ (instruction, maxLocals) =>
			BytecodeExample.of(instruction).code.maxLocals should be(maxLocals)
		}
	}
}